<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Armazenamento Seguro de Dados</title>
</head>
<body>
    <h1>Armazenamento Seguro de Dados</h1>
    
    <label for="dado">Dado:</label>
    <input type="text" id="dado">
    
    <label for="senhaEnviar">Senha:</label>
    <input type="password" id="senhaEnviar">
    
    <button onclick="enviarDado()">Enviar Dado e Senha</button>
    
    <hr>
    
    <label for="senhaVerificar">Senha:</label>
    <input type="password" id="senhaVerificar">
    
    <button onclick="verificarDado()">Verificar Dado</button>

    <div id="dadosExibidos"></div>

    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
    <script>
        const contratoAddress = '0x85Ed6f7436f2362CcCC32Bf7Dc6BdaA57336aC08';
        const contratoABI = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "senha",
				"type": "string"
			}
		],
		"name": "acessarDadoComSenha",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "dado",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "senha",
				"type": "string"
			}
		],
		"name": "enviarDado",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "sacarTaxa",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "usuario",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "string",
				"name": "dado",
				"type": "string"
			}
		],
		"name": "DadoEnviado",
		"type": "event"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "taxaAcesso",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "totalTaxa",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];
        const web3 = new Web3(Web3.givenProvider);
        const contrato = new web3.eth.Contract(contratoABI, contratoAddress);

        async function enviarDado() {
            const dado = document.getElementById("dado").value;
            const senha = document.getElementById("senhaEnviar").value;
            const contas = await web3.eth.getAccounts();
            await contrato.methods.enviarDado(dado, senha).send({ from: contas[0], value: web3.utils.toWei('0.01', 'ether') });
            alert("Dado e senha enviados com sucesso!");
        }

        async function verificarDado() {
            const senha = document.getElementById("senhaVerificar").value;
            await contrato.methods.acessarDadoComSenha(senha).send({ from: contas[0], value: web3.utils.toWei('0.0001', 'ether') });
            const dado = await contrato.methods.acessarDadoComSenha(senha).call();
            document.getElementById("dadosExibidos").innerText = "Dado verificado: " + dado;
        }
    </script>
</body>
</html>
